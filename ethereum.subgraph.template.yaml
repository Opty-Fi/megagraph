specVersion: 0.0.2
description: Opty-Fi's DeFi Adapters subgraph
repository: https://github.com/Opty-Fi/defi-protocol-subgraph
schema:
  file: {{{path-schema}}}
dataSources:
  {{#adapters}}
  # --------------------------------------
  #      {{adapter}}
  # --------------------------------------
  {{#contract-main}}
  - kind: ethereum/contract
    name: {{contract-main}}
    network: {{network}}
    source:
      address: "{{address}}"
      {{#startBlock}}
      startBlock: {{startBlock}}
      {{/startBlock}}
      abi: {{contract-main}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        {{#contract-main}}
        - {{adapter}}{{contract-main}}Data
        {{/contract-main}}
        - {{adapter}}TokenData
      abis:
        {{#contract-main}}
        - name: {{contract-main}}
          file: ./src/{{adapter}}/abis/{{contract-main}}.json
        {{/contract-main}}
        - name: {{adapter}}Token
          file: ./src/{{adapter}}/abis/{{adapter}}Token.json
      eventHandlers:
        {{#events-main}}
        - event: {{event}}{{params}}
          handler: handle{{event}}
        {{/events-main}}
      file: ./src/{{adapter}}/mappings/{{contract-main}}.ts
  {{/contract-main}}
  {{#tokens}}
  - kind: ethereum/contract
    name: {{adapter}}Token{{symbol}}
    network: {{network}}
    source:
      address: "{{address}}"
      {{#startBlock}}
      startBlock: {{startBlock}}
      {{/startBlock}}
      abi: {{adapter}}Token
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        {{#contract-main}}
        - {{adapter}}{{contract-main}}Data
        {{/contract-main}}
        - {{adapter}}TokenData
      abis:
        {{#contract-main}}
        - name: {{contract-main}}
          file: ./src/{{adapter}}/abis/{{contract-main}}.json
        {{/contract-main}}
        - name: {{adapter}}Token
          file: ./src/{{adapter}}/abis/{{adapter}}Token.json
      eventHandlers:
        {{#events-token}}
        - event: {{event}}{{params}}
          handler: handle{{event}}
        {{/events-token}}
      file: ./src/{{adapter}}/mappings/{{adapter}}Token.ts
  {{/tokens}}
  {{/adapters}}
  