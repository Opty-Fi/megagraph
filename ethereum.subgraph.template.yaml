specVersion: 0.0.2
description: Opty-Fi's DeFi Adapters subgraph
repository: https://github.com/Opty-Fi/defi-protocol-subgraph
schema:
  file: ./schema.graphql
dataSources:
{{#adapters}}
# ----------------------------------------
#      {{adapter}}
# ----------------------------------------
  {{#pool-contracts}}
  # ----------------------------------------
  #      {{adapter}} {{contract}}{{symbol}}
  # ----------------------------------------
  - kind: ethereum/contract
    name: {{adapter}}{{contract}}{{symbol}}
    network: {{network}}
    source:
      address: "{{address}}"
      {{#startBlock}}
      startBlock: {{startBlock}}
      {{/startBlock}}
      abi: {{adapter}}{{contract}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - {{adapter}}TokenData
      abis:
        - name: {{adapter}}Token
          file: ./src/{{adapter}}/abis/Token.json
        {{#supporting-abis}}
        - name: {{adapter}}{{.}}
          file: ./src/{{adapter}}/abis/{{.}}.json
        {{/supporting-abis}}
      eventHandlers:
        {{#pool-events}}
        - event: {{event}}{{params}}
          handler: handle{{event}}
        {{/pool-events}}
      file: ./src/{{adapter}}/mappings/{{contract}}.ts
  {{/pool-contracts}}
  {{#tokens}}
  # ----------------------------------------
  #      {{adapter}} Token {{symbol}}
  # ----------------------------------------
  - kind: ethereum/contract
    name: {{adapter}}Token{{symbol}}
    network: {{network}}
    source:
      address: "{{address}}"
      {{#startBlock}}
      startBlock: {{startBlock}}
      {{/startBlock}}
      abi: {{adapter}}Token
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - {{adapter}}TokenData
      abis:
        - name: {{adapter}}Token
          file: ./src/{{adapter}}/abis/Token.json
        {{#supporting-abis}}
        - name: {{adapter}}{{.}}
          file: ./src/{{adapter}}/abis/{{.}}.json
        {{/supporting-abis}}
      eventHandlers:
        {{#token-events}}
        - event: {{event}}{{params}}
          handler: handle{{event}}
        {{/token-events}}
      file: ./src/{{adapter}}/mappings/Token.ts
  {{/tokens}}
  {{#tokens-2}}
  # ----------------------------------------
  #      {{adapter}} Token2 {{symbol}}
  # ----------------------------------------
  - kind: ethereum/contract
    name: {{adapter}}Token2{{symbol}}
    network: {{network}}
    source:
      address: "{{address}}"
      {{#startBlock}}
      startBlock: {{startBlock}}
      {{/startBlock}}
      abi: {{adapter}}Token2
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - {{adapter}}TokenData
      abis:
        - name: {{adapter}}Token2
          file: ./src/{{adapter}}/abis/Token2.json
        {{#supporting-abis}}
        - name: {{adapter}}{{.}}
          file: ./src/{{adapter}}/abis/{{.}}.json
        {{/supporting-abis}}
      eventHandlers:
        {{#token-2-events}}
        - event: {{event}}{{params}}
          handler: handle{{event}}
        {{/token-2-events}}
      file: ./src/{{adapter}}/mappings/Token2.ts
  {{/tokens-2}}
{{/adapters}}
