specVersion: 0.0.2
description: Opty-Fi's DeFi Adapters subgraph
repository: https://github.com/Opty-Fi/defi-protocol-subgraph
schema:
  file: ./schema.graphql
dataSources:
{{#adapters}}
# ----------------------------------------
#      {{adapter}}
# ----------------------------------------
  {{#pool-contract}}
  # ----------------------------------------
  #      {{adapter}} pool
  # ----------------------------------------
  - kind: ethereum/contract
    name: {{adapter}}{{pool-contract}}
    network: {{network}}
    source:
      address: "{{address}}"
      {{#startBlock}}
      startBlock: {{startBlock}}
      {{/startBlock}}
      abi: {{adapter}}{{pool-contract}}
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        {{#pool-contract}}
        - {{adapter}}{{pool-contract}}Data
        {{/pool-contract}}
        - {{adapter}}TokenData
      abis:
        {{#pool-contract}}
        - name: {{adapter}}{{pool-contract}}
          file: ./src/{{adapter}}/abis/{{pool-contract}}.json
        {{/pool-contract}}
        - name: {{adapter}}Token
          file: ./src/{{adapter}}/abis/Token.json
      eventHandlers:
        {{#pool-events}}
        - event: {{event}}{{params}}
          handler: handle{{event}}
        {{/pool-events}}
      file: ./src/{{adapter}}/mappings/{{pool-contract}}.ts
  {{/pool-contract}}
  {{#tokens}}
  # ----------------------------------------
  #      {{adapter}} {{symbol}}
  # ----------------------------------------
  - kind: ethereum/contract
    name: {{adapter}}Token{{symbol}}
    network: {{network}}
    source:
      address: "{{address}}"
      {{#startBlock}}
      startBlock: {{startBlock}}
      {{/startBlock}}
      abi: {{adapter}}Token
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        {{#pool-contract}}
        - {{adapter}}{{pool-contract}}Data
        {{/pool-contract}}
        - {{adapter}}TokenData
      abis:
        {{#pool-contract}}
        - name: {{adapter}}{{pool-contract}}
          file: ./src/{{adapter}}/abis/{{pool-contract}}.json
        {{/pool-contract}}
        - name: {{adapter}}Token
          file: ./src/{{adapter}}/abis/Token.json
        {{#token-supporting-abis}}
        - name: {{adapter}}{{.}}
          file: ./src/{{adapter}}/abis/{{.}}.json
        {{/token-supporting-abis}}
      eventHandlers:
        {{#token-events}}
        - event: {{event}}{{params}}
          handler: handle{{event}}
        {{/token-events}}
      file: ./src/{{adapter}}/mappings/Token.ts
  {{/tokens}}
{{/adapters}}
  